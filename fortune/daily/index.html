<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ëŠ˜ì˜ ìš´ì„¸ - ì‚¬ì£¼ ê¸°ë°˜ ì •í™•í•œ ì¼ì¼ìš´ì„¸ | doha.kr</title>
    <meta name="description" content="ì •í™•í•œ ë§Œì„¸ë ¥ ì‚¬ì£¼íŒ”ìë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” ì˜¤ëŠ˜ì˜ ìš´ì„¸. ìƒë…„ì›”ì¼ì‹œë¥¼ ì…ë ¥í•˜ì—¬ ìƒì„¸í•œ ì¼ì¼ ìš´ì„¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    
    <!-- Open Graph -->
    <meta property="og:title" content="ì˜¤ëŠ˜ì˜ ìš´ì„¸ - ì‚¬ì£¼ ê¸°ë°˜ ì¼ì¼ìš´ì„¸ | doha.kr">
    <meta property="og:description" content="ë§Œì„¸ë ¥ ê¸°ë°˜ ì •í™•í•œ ì‚¬ì£¼íŒ”ìë¡œ ë³´ëŠ” ì˜¤ëŠ˜ì˜ ìš´ì„¸">
    <meta property="og:image" content="https://doha.kr/images/og-default.png">
    <meta property="og:url" content="https://doha.kr/fortune/daily/">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Modular CSS -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/fortune/fortune-base.css">
    <link rel="stylesheet" href="/css/fortune/fortune-loading-fix.css">
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7905640648499222" crossorigin="anonymous"></script>
    
    <!-- Kakao SDK -->
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.4.0/kakao.min.js" integrity="sha384-mXVrIX2T/Kszp6Z0aEWaA8Nm7J6/ZeWXbL8UpGRjKwWe56Srd/iyNmWMBhcItAjH" crossorigin="anonymous"></script>
    
    <!-- í–¥ìƒëœ ë§Œì„¸ë ¥ ì‹œìŠ¤í…œ ë¡œë“œ -->
    <script src="/js/lunar-calendar-compact.js"></script>
    <script src="/js/lunar-calendar-loader.js"></script>
    <script src="/js/saju-calculator-enhanced.js"></script>
</head>
<body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <div id="navbar-placeholder"></div>
    
    <!-- ìš´ì„¸ ì»¨í…Œì´ë„ˆ -->
    <div class="fortune-container">
        <!-- í—¤ë” -->
        <div class="fortune-header">
            <h1 class="fortune-title">âœ¨ ì˜¤ëŠ˜ì˜ ìš´ì„¸</h1>
            <p class="fortune-subtitle">
                ì •í™•í•œ ë§Œì„¸ë ¥ ê¸°ë°˜ ì‚¬ì£¼íŒ”ì ì¼ì¼ ìš´ì„¸ ë¶„ì„
            </p>
        </div>
        
        <!-- ìš´ì„¸ ì…ë ¥ í¼ -->
        <div class="fortune-main" id="fortuneForm">
            <h2 style="text-align: center; margin-bottom: 30px; color: var(--fortune-dark);">ë‹¹ì‹ ì˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</h2>
            <form onsubmit="generateDailyFortune(event)">
                <div class="fortune-input-section">
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div class="fortune-input-group" style="flex: 1;">
                            <label for="userName" class="fortune-label">ì´ë¦„</label>
                            <input type="text" id="userName" name="userName" class="fortune-input" placeholder="í™ê¸¸ë™" required>
                        </div>
                        
                        <div class="fortune-input-group" style="flex: 1;">
                            <label for="gender" class="fortune-label">ì„±ë³„</label>
                            <select id="gender" name="gender" class="fortune-select">
                                <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                <option value="male">ë‚¨ì„±</option>
                                <option value="female">ì—¬ì„±</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div class="fortune-input-group" style="flex: 1;">
                            <label for="birthYear" class="fortune-label">ìƒë…„</label>
                            <input type="number" id="birthYear" name="birthYear" class="fortune-input" min="1900" max="2025" placeholder="1990" required>
                        </div>
                        
                        <div class="fortune-input-group" style="flex: 1;">
                            <label for="birthMonth" class="fortune-label">ìƒì›”</label>
                            <input type="number" id="birthMonth" name="birthMonth" class="fortune-input" min="1" max="12" placeholder="1" required>
                        </div>
                        
                        <div class="fortune-input-group" style="flex: 1;">
                            <label for="birthDay" class="fortune-label">ìƒì¼</label>
                            <input type="number" id="birthDay" name="birthDay" class="fortune-input" min="1" max="31" placeholder="1" required>
                        </div>
                    </div>
                    
                    <div class="fortune-input-group">
                        <label for="birthTime" class="fortune-label">ì¶œìƒì‹œê°„</label>
                        <select id="birthTime" name="birthTime" class="fortune-select">
                            <option value="-1">ëª¨ë¦„</option>
                            <option value="23">ìì‹œ (23:00-00:59)</option>
                            <option value="1">ì¶•ì‹œ (01:00-02:59)</option>
                            <option value="3">ì¸ì‹œ (03:00-04:59)</option>
                            <option value="5">ë¬˜ì‹œ (05:00-06:59)</option>
                            <option value="7">ì§„ì‹œ (07:00-08:59)</option>
                            <option value="9">ì‚¬ì‹œ (09:00-10:59)</option>
                            <option value="11">ì˜¤ì‹œ (11:00-12:59)</option>
                            <option value="13">ë¯¸ì‹œ (13:00-14:59)</option>
                            <option value="15">ì‹ ì‹œ (15:00-16:59)</option>
                            <option value="17">ìœ ì‹œ (17:00-18:59)</option>
                            <option value="19">ìˆ ì‹œ (19:00-20:59)</option>
                            <option value="21">í•´ì‹œ (21:00-22:59)</option>
                        </select>
                    </div>
                    
                    <div class="fortune-input-group">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="isLunar" name="isLunar" style="margin-right: 8px;">
                            <span class="fortune-label" style="margin-bottom: 0;">ìŒë ¥ ìƒì¼ì…ë‹ˆë‹¤</span>
                        </label>
                    </div>
                    
                    <button type="submit" class="fortune-btn fortune-btn-primary" style="width: 100%; margin-top: 30px;">
                        âœ¨ ì •í™•í•œ ë§Œì„¸ë ¥ ìš´ì„¸ ë³´ê¸°
                    </button>
                </div>
            </form>
        </div>
        
        <!-- ìš´ì„¸ ê²°ê³¼ -->
        <div id="fortuneResult" style="display: none;"></div>
        
        <!-- ê´‘ê³  ì˜ì—­ -->
        <div class="ad-container" style="margin: 40px 0;">
            <div class="ad-label">ê´‘ê³ </div>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7905640648499222"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>
    </div>
    
    <!-- í‘¸í„° -->
    <div id="footer-placeholder"></div>
    
    <!-- External JavaScript -->
    <script src="/js/main.js"></script>
    <script src="/js/security.js"></script>
    
    <script>
        // í–¥ìƒëœ ì‚¬ì£¼ ê³„ì‚°ê¸° ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        let sajuCalculator = null;
        let currentFortuneData = null;
        
        // ì¹´ì¹´ì˜¤ SDK ì´ˆê¸°í™”
        if (window.Kakao && !window.Kakao.isInitialized()) {
            Kakao.init('19d8ba832f94d513957adc17883c1282');
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // í–¥ìƒëœ ì‚¬ì£¼ ê³„ì‚°ê¸° ì´ˆê¸°í™”
            if (typeof SajuCalculatorEnhanced !== 'undefined') {
                sajuCalculator = new SajuCalculatorEnhanced();
                console.log('í–¥ìƒëœ ì‚¬ì£¼ ê³„ì‚°ê¸° ë¡œë“œ ì™„ë£Œ');
            } else {
                console.log('í–¥ìƒëœ ì‚¬ì£¼ ê³„ì‚°ê¸° ë¡œë“œ ì‹¤íŒ¨, ê¸°ë³¸ ê³„ì‚°ê¸° ì‚¬ìš©');
            }
        });
        
        // ì¼ì¼ ìš´ì„¸ ìƒì„± í•¨ìˆ˜
        function generateDailyFortune(event) {
            event.preventDefault();
            
            const userName = Security.sanitizeInput(document.getElementById('userName').value, 'text');
            const birthYear = Security.validateNumber(document.getElementById('birthYear').value, 1900, 2025);
            const birthMonth = Security.validateNumber(document.getElementById('birthMonth').value, 1, 12);
            const birthDay = Security.validateNumber(document.getElementById('birthDay').value, 1, 31);
            const birthTime = Security.validateNumber(document.getElementById('birthTime').value, 0, 23);
            const isLunar = document.getElementById('isLunar').checked;
            
            // í†µí•© ë¡œë”© í‘œì‹œ (í…ìŠ¤íŠ¸ íšŒì „ ë°©ì§€)
            const resultDiv = document.getElementById('fortuneResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div class="fortune-loading">
                    <div class="fortune-loading-icon">ğŸ”®</div>
                    <div class="fortune-loading-spinner"></div>
                    <p class="fortune-loading-text">ì •í™•í•œ ë§Œì„¸ë ¥ìœ¼ë¡œ ${userName}ë‹˜ì˜ ì‚¬ì£¼ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                </div>
            `;
            
            // í¼ ìˆ¨ê¸°ê¸°
            document.getElementById('fortuneForm').style.display = 'none';
            
            // ìš´ì„¸ ìƒì„± (í–¥ìƒëœ ê³„ì‚°ê¸° ì‚¬ìš©)
            setTimeout(() => {
                displayDailyFortune(userName, birthYear, birthMonth, birthDay, birthTime, isLunar);
            }, 2000);
        }
        
        // ì¼ì¼ ìš´ì„¸ í‘œì‹œ í•¨ìˆ˜
        async function displayDailyFortune(userName, birthYear, birthMonth, birthDay, birthTime, isLunar) {
            try {
                // í–¥ìƒëœ ì‚¬ì£¼ ê³„ì‚°ê¸° ì‚¬ìš©
                if (!sajuCalculator) {
                    throw new Error('ì‚¬ì£¼ ê³„ì‚°ê¸°ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                // ì‚¬ì£¼ ê³„ì‚° (í–¥ìƒëœ ë§Œì„¸ë ¥ ë°ì´í„° ì‚¬ìš©)
                const saju = await sajuCalculator.calculateSaju(
                    birthYear, 
                    birthMonth, 
                    birthDay, 
                    birthTime >= 0 ? birthTime : 12, 
                    isLunar
                );
                
                // ì˜¤ëŠ˜ ë‚ ì§œ
                const today = new Date();
                const todayPillar = sajuCalculator.calculateDayPillar(
                    today.getFullYear(), 
                    today.getMonth() + 1, 
                    today.getDate()
                );
                
                // ì‚¬ì£¼ í•´ì„ ìƒì„±
                const interpretation = sajuCalculator.generateInterpretation(saju);
                
                // ì¼ì£¼ ê´€ê³„ ë¶„ì„
                const relation = analyzeRelation(saju.dayPillar, todayPillar);
                const fortune = generateDetailedFortune(saju, todayPillar, relation);
                
                // ê²°ê³¼ ë°ì´í„° ì €ì¥ (ê³µìœ ìš©)
                currentFortuneData = {
                    userName,
                    birthYear,
                    birthMonth,
                    birthDay,
                    saju,
                    fortune,
                    today
                };
                
                const resultDiv = document.getElementById('fortuneResult');
                resultDiv.innerHTML = `
                    <div class="fortune-result show">
                        <div class="fortune-result-header">
                            <h2 class="fortune-result-title">
                                ğŸ”® ${userName}ë‹˜ì˜ ${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼ ìš´ì„¸
                            </h2>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸ“… ì‚¬ì£¼íŒ”ì (å››æŸ±å…«å­—)</h3>
                            <div class="fortune-cards">
                                <div class="fortune-card">
                                    <div class="fortune-card-title">ì—°ì£¼ (å¹´æŸ±)</div>
                                    <div class="fortune-card-icon" style="font-size: 24px; margin: 16px 0;">
                                        ${saju.yearPillar.stem}${saju.yearPillar.branch}
                                    </div>
                                    <div class="fortune-card-desc">${saju.tenGods.year}</div>
                                </div>
                                
                                <div class="fortune-card">
                                    <div class="fortune-card-title">ì›”ì£¼ (æœˆæŸ±)</div>
                                    <div class="fortune-card-icon" style="font-size: 24px; margin: 16px 0;">
                                        ${saju.monthPillar.stem}${saju.monthPillar.branch}
                                    </div>
                                    <div class="fortune-card-desc">${saju.tenGods.month}</div>
                                </div>
                                
                                <div class="fortune-card selected">
                                    <div class="fortune-card-title">ì¼ì£¼ (æ—¥æŸ±) â­</div>
                                    <div class="fortune-card-icon" style="font-size: 24px; margin: 16px 0;">
                                        ${saju.dayPillar.stem}${saju.dayPillar.branch}
                                    </div>
                                    <div class="fortune-card-desc">ì¼ì£¼(ë³¸ì¸)</div>
                                </div>
                                
                                <div class="fortune-card ${birthTime < 0 ? 'unknown' : ''}">
                                    <div class="fortune-card-title">ì‹œì£¼ (æ™‚æŸ±)</div>
                                    <div class="fortune-card-icon" style="font-size: 24px; margin: 16px 0;">
                                        ${birthTime >= 0 ? saju.hourPillar.stem + saju.hourPillar.branch : '??'}
                                    </div>
                                    <div class="fortune-card-desc">${birthTime >= 0 ? saju.tenGods.hour : 'ë¯¸ìƒ'}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="fortune-result-section" style="background: var(--fortune-gradient); color: white;">
                            <h3>ğŸŒ… ì˜¤ëŠ˜ì˜ ì¼ì§„</h3>
                            <div style="text-align: center; font-size: 2rem; font-weight: 700; margin: 20px 0;">
                                ${todayPillar.stem}${todayPillar.branch}ì¼
                            </div>
                            <p style="text-align: center; margin: 0;">
                                (${todayPillar.stem}${todayPillar.branch}æ—¥)
                            </p>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸŒŸ ìš´ì„¸ ì ìˆ˜</h3>
                            <div class="fortune-cards">
                                <div class="fortune-card">
                                    <div class="fortune-card-icon">ğŸ’«</div>
                                    <div class="fortune-card-title">ì´ìš´</div>
                                    <div class="fortune-card-desc" style="font-size: 24px; font-weight: 700; color: ${getScoreColor(fortune.overallScore)};">
                                        ${fortune.overallScore}ì 
                                    </div>
                                </div>
                                
                                <div class="fortune-card">
                                    <div class="fortune-card-icon">â¤ï¸</div>
                                    <div class="fortune-card-title">ì• ì •ìš´</div>
                                    <div class="fortune-card-desc" style="font-size: 24px; font-weight: 700; color: ${getScoreColor(fortune.loveScore)};">
                                        ${fortune.loveScore}ì 
                                    </div>
                                </div>
                                
                                <div class="fortune-card">
                                    <div class="fortune-card-icon">ğŸ’°</div>
                                    <div class="fortune-card-title">ê¸ˆì „ìš´</div>
                                    <div class="fortune-card-desc" style="font-size: 24px; font-weight: 700; color: ${getScoreColor(fortune.moneyScore)};">
                                        ${fortune.moneyScore}ì 
                                    </div>
                                </div>
                                
                                <div class="fortune-card">
                                    <div class="fortune-card-icon">ğŸƒ</div>
                                    <div class="fortune-card-title">ê±´ê°•ìš´</div>
                                    <div class="fortune-card-desc" style="font-size: 24px; font-weight: 700; color: ${getScoreColor(fortune.healthScore)};">
                                        ${fortune.healthScore}ì 
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸ’« ì´ìš´</h3>
                            <p>${fortune.overallFortune}</p>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>â¤ï¸ ì• ì •ìš´</h3>
                            <p>${fortune.loveFortune}</p>
                            <div style="background: rgba(139, 92, 246, 0.1); padding: 16px; border-radius: 8px; margin-top: 16px;">
                                <strong>ğŸ’¡ ì¡°ì–¸:</strong> ${fortune.loveAdvice}
                            </div>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸ’° ê¸ˆì „ìš´</h3>
                            <p>${fortune.moneyFortune}</p>
                            <div style="background: rgba(139, 92, 246, 0.1); padding: 16px; border-radius: 8px; margin-top: 16px;">
                                <strong>ğŸ’¡ ì¡°ì–¸:</strong> ${fortune.moneyAdvice}
                            </div>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸ’¼ ì§ì—…ìš´</h3>
                            <p>${fortune.careerFortune}</p>
                            <div style="background: rgba(139, 92, 246, 0.1); padding: 16px; border-radius: 8px; margin-top: 16px;">
                                <strong>ğŸ’¡ ì¡°ì–¸:</strong> ${fortune.careerAdvice}
                            </div>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸƒ ê±´ê°•ìš´</h3>
                            <p>${fortune.healthFortune}</p>
                            <div style="background: rgba(139, 92, 246, 0.1); padding: 16px; border-radius: 8px; margin-top: 16px;">
                                <strong>ğŸ’¡ ì¡°ì–¸:</strong> ${fortune.healthAdvice}
                            </div>
                        </div>
                        
                        <div class="fortune-result-section" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                            <h3>ğŸŒŸ ì˜¤ëŠ˜ì˜ í–‰ìš´ ìš”ì†Œ</h3>
                            <div class="fortune-cards">
                                <div style="background: rgba(255, 255, 255, 0.2); padding: 20px; border-radius: 8px; text-align: center; color: white;">
                                    <div style="font-size: 32px; margin-bottom: 10px;">â°</div>
                                    <div style="font-size: 14px; margin-bottom: 8px; opacity: 0.9;">í–‰ìš´ì˜ ì‹œê°„</div>
                                    <div style="font-size: 18px; font-weight: 700;">${fortune.luckyTime}</div>
                                </div>
                                <div style="background: rgba(255, 255, 255, 0.2); padding: 20px; border-radius: 8px; text-align: center; color: white;">
                                    <div style="font-size: 32px; margin-bottom: 10px;">ğŸ§­</div>
                                    <div style="font-size: 14px; margin-bottom: 8px; opacity: 0.9;">í–‰ìš´ì˜ ë°©í–¥</div>
                                    <div style="font-size: 18px; font-weight: 700;">${fortune.luckyDirection}</div>
                                </div>
                                <div style="background: rgba(255, 255, 255, 0.2); padding: 20px; border-radius: 8px; text-align: center; color: white;">
                                    <div style="font-size: 32px; margin-bottom: 10px;">ğŸ¨</div>
                                    <div style="font-size: 14px; margin-bottom: 8px; opacity: 0.9;">í–‰ìš´ì˜ ìƒ‰ìƒ</div>
                                    <div style="font-size: 18px; font-weight: 700;">${fortune.luckyColor}</div>
                                </div>
                                <div style="background: rgba(255, 255, 255, 0.2); padding: 20px; border-radius: 8px; text-align: center; color: white;">
                                    <div style="font-size: 32px; margin-bottom: 10px;">ğŸ”¢</div>
                                    <div style="font-size: 14px; margin-bottom: 8px; opacity: 0.9;">í–‰ìš´ì˜ ìˆ«ì</div>
                                    <div style="font-size: 18px; font-weight: 700;">${fortune.luckyNumber}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="fortune-result-section">
                            <h3>ğŸ“ ì˜¤ëŠ˜ì˜ ì¡°ì–¸</h3>
                            <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: 20px;">${fortune.advice}</p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div style="background: rgba(16, 185, 129, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
                                    <strong style="color: #10b981; display: block; margin-bottom: 5px;">âœ… ì˜¤ëŠ˜ í•˜ë©´ ì¢‹ì€ ì¼</strong>
                                    ${fortune.doAdvice}
                                </div>
                                <div style="background: rgba(239, 68, 68, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                                    <strong style="color: #ef4444; display: block; margin-bottom: 5px;">âŒ ì˜¤ëŠ˜ í”¼í•´ì•¼ í•  ì¼</strong>
                                    ${fortune.dontAdvice}
                                </div>
                            </div>
                        </div>
                        
                        <div class="fortune-share">
                            <h3 class="fortune-share-title">ê²°ê³¼ ê³µìœ í•˜ê¸°</h3>
                            <div class="fortune-share-buttons">
                                <button class="fortune-share-btn fortune-share-kakao" onclick="shareFortune()">
                                    ğŸ’¬ ì¹´ì¹´ì˜¤í†¡ ê³µìœ 
                                </button>
                                <button class="fortune-share-btn fortune-share-copy" onclick="copyResultLink()">
                                    ğŸ”— ë§í¬ ë³µì‚¬
                                </button>
                            </div>
                            <div style="display: flex; gap: 16px; justify-content: center; margin-top: 20px;">
                                <button onclick="location.reload()" class="fortune-btn fortune-btn-primary">ë‹¤ì‹œ ë³´ê¸°</button>
                                <a href="/fortune/" class="fortune-btn fortune-btn-secondary">ë‹¤ë¥¸ ìš´ì„¸ ë³´ê¸°</a>
                            </div>
                        </div>
                    </div>
                `;
                
                resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
            } catch (error) {
                console.error('ìš´ì„¸ ê³„ì‚° ì¤‘ ì˜¤ë¥˜:', error);
                const resultDiv = document.getElementById('fortuneResult');
                resultDiv.innerHTML = `
                    <div class="fortune-result show">
                        <div class="fortune-result-header">
                            <h2 class="fortune-result-title" style="color: #e74c3c;">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h2>
                            <p class="fortune-result-subtitle">
                                ìš´ì„¸ ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
                            </p>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="location.reload()" class="fortune-btn fortune-btn-primary">ë‹¤ì‹œ ì‹œë„</button>
                        </div>
                    </div>
                `;
            }
        }
        
        // ê´€ê³„ ë¶„ì„ í•¨ìˆ˜ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
        function analyzeRelation(dayPillar, todayPillar) {
            const relations = {
                stemRelation: analyzeStemRelation(dayPillar.stem, todayPillar.stem),
                branchRelation: analyzeBranchRelation(dayPillar.branch, todayPillar.branch),
                specialRelation: findSpecialRelation(dayPillar.branch, todayPillar.branch)
            };
            
            return relations;
        }
        
        // ì²œê°„ ê´€ê³„ ë¶„ì„
        function analyzeStemRelation(stem1, stem2) {
            const stemElements = {
                'ê°‘': 'ëª©', 'ì„': 'ëª©',
                'ë³‘': 'í™”', 'ì •': 'í™”',
                'ë¬´': 'í† ', 'ê¸°': 'í† ',
                'ê²½': 'ê¸ˆ', 'ì‹ ': 'ê¸ˆ',
                'ì„': 'ìˆ˜', 'ê³„': 'ìˆ˜'
            };
            
            const element1 = stemElements[stem1];
            const element2 = stemElements[stem2];
            
            const relations = {
                'ëª©': { generate: 'í™”', control: 'í† ', generated: 'ìˆ˜', controlled: 'ê¸ˆ' },
                'í™”': { generate: 'í† ', control: 'ê¸ˆ', generated: 'ëª©', controlled: 'ìˆ˜' },
                'í† ': { generate: 'ê¸ˆ', control: 'ìˆ˜', generated: 'í™”', controlled: 'ëª©' },
                'ê¸ˆ': { generate: 'ìˆ˜', control: 'ëª©', generated: 'í† ', controlled: 'í™”' },
                'ìˆ˜': { generate: 'ëª©', control: 'í™”', generated: 'ê¸ˆ', controlled: 'í† ' }
            };
            
            if (element1 === element2) return 'same';
            if (relations[element1].generate === element2) return 'generate';
            if (relations[element1].generated === element2) return 'generated';
            if (relations[element1].control === element2) return 'control';
            if (relations[element1].controlled === element2) return 'controlled';
            
            return 'none';
        }
        
        // ì§€ì§€ ê´€ê³„ ë¶„ì„
        function analyzeBranchRelation(branch1, branch2) {
            const branchElements = {
                'ì': 'ìˆ˜', 'ì¶•': 'í† ', 'ì¸': 'ëª©', 'ë¬˜': 'ëª©',
                'ì§„': 'í† ', 'ì‚¬': 'í™”', 'ì˜¤': 'í™”', 'ë¯¸': 'í† ',
                'ì‹ ': 'ê¸ˆ', 'ìœ ': 'ê¸ˆ', 'ìˆ ': 'í† ', 'í•´': 'ìˆ˜'
            };
            
            const element1 = branchElements[branch1];
            const element2 = branchElements[branch2];
            
            return analyzeStemRelation(element1, element2);
        }
        
        // íŠ¹ìˆ˜ ê´€ê³„ ì°¾ê¸°
        function findSpecialRelation(branch1, branch2) {
            const combinations = {
                'ì': 'ì¶•', 'ì¶•': 'ì',
                'ì¸': 'í•´', 'í•´': 'ì¸',
                'ë¬˜': 'ìˆ ', 'ìˆ ': 'ë¬˜',
                'ì§„': 'ìœ ', 'ìœ ': 'ì§„',
                'ì‚¬': 'ì‹ ', 'ì‹ ': 'ì‚¬',
                'ì˜¤': 'ë¯¸', 'ë¯¸': 'ì˜¤'
            };
            
            const clashes = {
                'ì': 'ì˜¤', 'ì˜¤': 'ì',
                'ì¶•': 'ë¯¸', 'ë¯¸': 'ì¶•',
                'ì¸': 'ì‹ ', 'ì‹ ': 'ì¸',
                'ë¬˜': 'ìœ ', 'ìœ ': 'ë¬˜',
                'ì§„': 'ìˆ ', 'ìˆ ': 'ì§„',
                'ì‚¬': 'í•´', 'í•´': 'ì‚¬'
            };
            
            const punishments = {
                'ì¸': ['ì‚¬', 'ì‹ '], 'ì‚¬': ['ì¸', 'ì‹ '], 'ì‹ ': ['ì¸', 'ì‚¬'],
                'ì¶•': ['ìˆ ', 'ë¯¸'], 'ìˆ ': ['ì¶•', 'ë¯¸'], 'ë¯¸': ['ì¶•', 'ìˆ ']
            };
            
            if (combinations[branch1] === branch2) {
                return { type: 'ìœ¡í•©', strength: 'positive' };
            }
            
            if (clashes[branch1] === branch2) {
                return { type: 'ì¶©', strength: 'negative' };
            }
            
            if (punishments[branch1] && punishments[branch1].includes(branch2)) {
                return { type: 'í˜•', strength: 'negative' };
            }
            
            return { type: 'none', strength: 'neutral' };
        }
        
        // ìƒì„¸ ìš´ì„¸ ìƒì„±
        function generateDetailedFortune(saju, todayPillar, relation) {
            const baseScore = 65;
            let overallScore = baseScore;
            
            if (relation.stemRelation === 'generate' || relation.stemRelation === 'generated') {
                overallScore += 10;
            } else if (relation.stemRelation === 'control' || relation.stemRelation === 'controlled') {
                overallScore -= 10;
            }
            
            if (relation.specialRelation.type === 'ìœ¡í•©') {
                overallScore += 20;
            } else if (relation.specialRelation.type === 'ì¶©') {
                overallScore -= 15;
            } else if (relation.specialRelation.type === 'í˜•') {
                overallScore -= 10;
            }
            
            overallScore = Math.max(20, Math.min(95, overallScore));
            
            const loveScore = Math.max(20, Math.min(95, overallScore + Math.floor(Math.random() * 20 - 10)));
            const moneyScore = Math.max(20, Math.min(95, overallScore + Math.floor(Math.random() * 20 - 10)));
            const healthScore = Math.max(20, Math.min(95, overallScore + Math.floor(Math.random() * 20 - 10)));
            const careerScore = Math.max(20, Math.min(95, overallScore + Math.floor(Math.random() * 20 - 10)));
            
            const overallFortune = generateOverallMessage(saju, overallScore, relation);
            const loveFortune = generateLoveMessage(saju, loveScore, relation);
            const moneyFortune = generateMoneyMessage(saju, moneyScore, relation);
            const careerFortune = generateCareerMessage(saju, careerScore, relation);
            const healthFortune = generateHealthMessage(saju, healthScore, relation);
            
            const luckyElements = generateLuckyElements(saju, todayPillar);
            const advice = generateAdvice(saju, todayPillar, relation);
            
            return {
                overallScore,
                loveScore,
                moneyScore,
                healthScore,
                overallFortune,
                loveFortune,
                loveAdvice: generateLoveAdvice(saju, loveScore),
                moneyFortune,
                moneyAdvice: generateMoneyAdvice(saju, moneyScore),
                careerFortune,
                careerAdvice: generateCareerAdvice(saju, careerScore),
                healthFortune,
                healthAdvice: generateHealthAdvice(saju, healthScore),
                ...luckyElements,
                ...advice
            };
        }
        
        // ë©”ì‹œì§€ ìƒì„± í•¨ìˆ˜ë“¤
        function generateOverallMessage(saju, score) {
            const dayMaster = saju.dayPillar.stem + saju.dayPillar.branch;
            if (score >= 80) {
                return `${dayMaster}ì¼ì£¼ì¸ ë‹¹ì‹ ì˜ ì˜¤ëŠ˜ ìš´ì„¸ëŠ” ë§¤ìš° ì¢‹ìŠµë‹ˆë‹¤! í‰ì†Œ ë¯¸ë¤„ì™”ë˜ ì¤‘ìš”í•œ ì¼ì„ ì‹œì‘í•˜ê¸°ì— ìµœì ì˜ ë‚ ì…ë‹ˆë‹¤.`;
            } else if (score >= 60) {
                return `${dayMaster}ì¼ì£¼ì¸ ë‹¹ì‹ ì˜ ì˜¤ëŠ˜ ìš´ì„¸ëŠ” í‰ê·  ì´ìƒì…ë‹ˆë‹¤. ì•ˆì •ì ì¸ íë¦„ ì†ì—ì„œ ì°¨ê·¼ì°¨ê·¼ ì¼ì„ ì§„í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤.`;
            } else {
                return `${dayMaster}ì¼ì£¼ì¸ ë‹¹ì‹ ì˜ ì˜¤ëŠ˜ ìš´ì„¸ëŠ” ë‹¤ì†Œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë¬´ë¦¬í•˜ì§€ ë§ê³  ì‹ ì¤‘í•˜ê²Œ í–‰ë™í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.`;
            }
        }
        
        function generateLoveMessage(saju, score) {
            if (score >= 80) {
                return 'ì• ì •ìš´ì´ ë§¤ìš° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤. ì—°ì¸ì´ ìˆë‹¤ë©´ ê¹Šì€ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ê¸° ì¢‹ê³ , ì‹±ê¸€ì´ë¼ë©´ ìƒˆë¡œìš´ ë§Œë‚¨ì˜ ê¸°íšŒê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            } else if (score >= 60) {
                return 'í‰ì˜¨í•œ ì• ì •ìš´ì…ë‹ˆë‹¤. ì„œë¡œë¥¼ ì´í•´í•˜ê³  ë°°ë ¤í•˜ëŠ” ë§ˆìŒì´ ì¤‘ìš”í•œ ì‹œê¸°ì…ë‹ˆë‹¤.';
            } else {
                return 'ì• ì • ê´€ê³„ì—ì„œ ì•½ê°„ì˜ ê¸´ì¥ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒëŒ€ë°©ì˜ ì…ì¥ì„ ì´í•´í•˜ë ¤ê³  ë…¸ë ¥í•˜ì„¸ìš”.';
            }
        }
        
        function generateMoneyMessage(saju, score) {
            if (score >= 80) {
                return 'ê¸ˆì „ìš´ì´ ìƒìŠ¹í•˜ëŠ” ë‚ ì…ë‹ˆë‹¤. íˆ¬ìë‚˜ ì‚¬ì—…ì—ì„œ ì¢‹ì€ ê¸°íšŒë¥¼ í¬ì°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            } else if (score >= 60) {
                return 'ì•ˆì •ì ì¸ ê¸ˆì „ íë¦„ì´ ì˜ˆìƒë©ë‹ˆë‹¤. ê³„íšì ì¸ ì†Œë¹„ì™€ ì €ì¶•ì„ ì‹¤ì²œí•˜ê¸° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤.';
            } else {
                return 'ê¸ˆì „ì ìœ¼ë¡œ ì‹ ì¤‘í•´ì•¼ í•˜ëŠ” ë‚ ì…ë‹ˆë‹¤. í° ì§€ì¶œì´ë‚˜ íˆ¬ìëŠ” ë¯¸ë£¨ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤.';
            }
        }
        
        function generateCareerMessage(saju, score) {
            if (score >= 80) {
                return 'ì§ì¥ì—ì„œì˜ ì„±ê³¼ê°€ ë‹ë³´ì´ëŠ” ë‚ ì…ë‹ˆë‹¤. ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë‚˜ ì¤‘ìš”í•œ ì—…ë¬´ë¥¼ ë§¡ê¸°ì— ì¢‹ì€ ì‹œê¸°ì…ë‹ˆë‹¤.';
            } else if (score >= 60) {
                return 'í‰ì†Œì™€ ê°™ì€ ì—…ë¬´ íë¦„ì´ ì´ì–´ì§‘ë‹ˆë‹¤. ë¬µë¬µíˆ ìì‹ ì˜ ì¼ì— ì§‘ì¤‘í•˜ë©´ ì¢‹ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            } else {
                return 'ì—…ë¬´ìƒ ì•½ê°„ì˜ ì–´ë ¤ì›€ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ê²°ì •ì€ ë‹¤ìŒìœ¼ë¡œ ë¯¸ë£¨ëŠ” ê²ƒì´ í˜„ëª…í•©ë‹ˆë‹¤.';
            }
        }
        
        function generateHealthMessage(saju, score) {
            if (score >= 80) {
                return 'ê±´ê°• ìƒíƒœê°€ ë§¤ìš° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤. ìš´ë™ì´ë‚˜ ì•¼ì™¸ í™œë™ì„ ì¦ê¸°ê¸°ì— ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤.';
            } else if (score >= 60) {
                return 'í‰ì†Œì™€ ë¹„ìŠ·í•œ ê±´ê°• ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê·œì¹™ì ì¸ ìƒí™œ ìŠµê´€ì„ ìœ ì§€í•˜ì„¸ìš”.';
            } else {
                return 'ì»¨ë””ì…˜ì´ ë‹¤ì†Œ ë–¨ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë‚ ì…ë‹ˆë‹¤. ë¬´ë¦¬í•œ í™œë™ì€ í”¼í•˜ê³  ì¶©ë¶„í•œ íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”.';
            }
        }
        
        // ì¡°ì–¸ ìƒì„± í•¨ìˆ˜ë“¤
        function generateLoveAdvice(saju, score) {
            if (score >= 80) {
                return 'ì˜¤ëŠ˜ì€ ì ê·¹ì ìœ¼ë¡œ ê°ì •ì„ í‘œí˜„í•˜ì„¸ìš”. ë¡œë§¨í‹±í•œ ë°ì´íŠ¸ë‚˜ ì§„ì‹¬ ì–´ë¦° ê³ ë°±ì´ ì¢‹ì€ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ê²ƒì…ë‹ˆë‹¤.';
            } else if (score >= 60) {
                return 'í‰ì†Œë³´ë‹¤ ë” ë§ì€ ê´€ì‹¬ê³¼ ë°°ë ¤ë¥¼ ë³´ì—¬ì£¼ì„¸ìš”. ì‘ì€ ì •ì„±ì´ í° ê°ë™ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
            } else {
                return 'ê°ì •ì ìœ¼ë¡œ ì˜ˆë¯¼í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì¤‘ìš”í•œ ëŒ€í™”ëŠ” ë¯¸ë£¨ì„¸ìš”. í˜¼ìë§Œì˜ ì‹œê°„ì„ ê°–ëŠ” ê²ƒë„ ì¢‹ìŠµë‹ˆë‹¤.';
            }
        }
        
        function generateMoneyAdvice(saju, score) {
            if (score >= 80) {
                return 'íˆ¬ìë‚˜ ì‚¬ì—… í™•ì¥ì˜ ì¢‹ì€ ê¸°íšŒì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ìš•ì‹¬ì„ ë¶€ë¦¬ì§€ ë§ê³  ë¶„ì‚° íˆ¬ìë¥¼ ê³ ë ¤í•˜ì„¸ìš”.';
            } else if (score >= 60) {
                return 'ì•ˆì •ì ì¸ ì¬í…Œí¬ ì „ëµì„ ìœ ì§€í•˜ì„¸ìš”. ì¥ê¸°ì ì¸ ê´€ì ì—ì„œ ê¾¸ì¤€íˆ ì €ì¶•í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.';
            } else {
                return 'ì§€ì¶œì„ ìµœì†Œí™”í•˜ê³  ë¹„ìƒê¸ˆì„ í™•ë³´í•˜ì„¸ìš”. ë¦¬ìŠ¤í¬ê°€ í° íˆ¬ìëŠ” í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.';
            }
        }
        
        function generateCareerAdvice(saju, score) {
            if (score >= 80) {
                return 'ìì‹ ê°ì„ ê°–ê³  ìƒˆë¡œìš´ ë„ì „ì„ ì‹œì‘í•˜ì„¸ìš”. ë‹¹ì‹ ì˜ ëŠ¥ë ¥ì´ ë¹›ì„ ë°œí•  ìµœì ì˜ ì‹œê¸°ì…ë‹ˆë‹¤.';
            } else if (score >= 60) {
                return 'ê¾¸ì¤€í•¨ì´ ì„±ê³µì˜ ì—´ì‡ ì…ë‹ˆë‹¤. í˜„ì¬ ë§¡ì€ ì¼ì— ìµœì„ ì„ ë‹¤í•˜ë©´ ì¢‹ì€ í‰ê°€ë¥¼ ë°›ì„ ê²ƒì…ë‹ˆë‹¤.';
            } else {
                return 'ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ë‘ ë²ˆ í™•ì¸í•˜ì„¸ìš”. ë™ë£Œë“¤ê³¼ì˜ ì†Œí†µì„ ê°•í™”í•˜ì—¬ í˜‘ë ¥ì„ êµ¬í•˜ì„¸ìš”.';
            }
        }
        
        function generateHealthAdvice(saju, score) {
            if (score >= 80) {
                return 'í™œë™ì ì¸ ìš´ë™ì„ ì¦ê¸°ê¸° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤. ìƒˆë¡œìš´ ìš´ë™ì„ ì‹œì‘í•˜ê±°ë‚˜ ì•¼ì™¸ í™œë™ì„ ê³„íší•´ë³´ì„¸ìš”.';
            } else if (score >= 60) {
                return 'ê·œì¹™ì ì¸ ìƒí™œ ë¦¬ë“¬ì„ ìœ ì§€í•˜ì„¸ìš”. ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ê³¼ ì¶©ë¶„í•œ ìˆ˜ë¶„ ì„­ì·¨ê°€ ë„ì›€ì´ ë©ë‹ˆë‹¤.';
            } else {
                return 'ë¬´ë¦¬í•˜ì§€ ë§ê³  ì¶©ë¶„í•œ íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”. ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ì™€ ëª…ìƒì´ ë„ì›€ì´ ë  ê²ƒì…ë‹ˆë‹¤.';
            }
        }
        
        // í–‰ìš´ ìš”ì†Œ ìƒì„±
        function generateLuckyElements(saju, todayPillar) {
            const dayMaster = saju.dayPillar.stem;
            
            const timeMap = {
                'ê°‘': 'ë¬˜ì‹œ (05:00-07:00)', 'ì„': 'ë¬˜ì‹œ (05:00-07:00)',
                'ë³‘': 'ì˜¤ì‹œ (11:00-13:00)', 'ì •': 'ì‚¬ì‹œ (09:00-11:00)',
                'ë¬´': 'ì§„ì‹œ (07:00-09:00)', 'ê¸°': 'ë¯¸ì‹œ (13:00-15:00)',
                'ê²½': 'ì‹ ì‹œ (15:00-17:00)', 'ì‹ ': 'ìœ ì‹œ (17:00-19:00)',
                'ì„': 'ìì‹œ (23:00-01:00)', 'ê³„': 'í•´ì‹œ (21:00-23:00)'
            };
            
            const directionMap = {
                'ëª©': 'ë™ìª½', 'í™”': 'ë‚¨ìª½', 'í† ': 'ì¤‘ì•™', 'ê¸ˆ': 'ì„œìª½', 'ìˆ˜': 'ë¶ìª½'
            };
            
            const colorMap = {
                'ëª©': 'ì´ˆë¡ìƒ‰, ì²­ë¡ìƒ‰', 'í™”': 'ë¹¨ê°„ìƒ‰, ë³´ë¼ìƒ‰', 'í† ': 'ë…¸ë€ìƒ‰, ê°ˆìƒ‰',
                'ê¸ˆ': 'í°ìƒ‰, ì€ìƒ‰', 'ìˆ˜': 'ê²€ì€ìƒ‰, íŒŒë€ìƒ‰'
            };
            
            const numberMap = {
                'ê°‘': '3, 8', 'ì„': '3, 8', 'ë³‘': '2, 7', 'ì •': '2, 7',
                'ë¬´': '5, 10', 'ê¸°': '5, 10', 'ê²½': '4, 9', 'ì‹ ': '4, 9',
                'ì„': '1, 6', 'ê³„': '1, 6'
            };
            
            const FIVE_ELEMENTS = {
                'ê°‘': 'ëª©', 'ì„': 'ëª©', 'ë³‘': 'í™”', 'ì •': 'í™”', 'ë¬´': 'í† ',
                'ê¸°': 'í† ', 'ê²½': 'ê¸ˆ', 'ì‹ ': 'ê¸ˆ', 'ì„': 'ìˆ˜', 'ê³„': 'ìˆ˜'
            };
            
            return {
                luckyTime: timeMap[dayMaster],
                luckyDirection: directionMap[FIVE_ELEMENTS[dayMaster]],
                luckyColor: colorMap[FIVE_ELEMENTS[dayMaster]],
                luckyNumber: numberMap[dayMaster]
            };
        }
        
        // ì¡°ì–¸ ìƒì„±
        function generateAdvice(saju, todayPillar, relation) {
            const dayMaster = saju.dayPillar.stem;
            const FIVE_ELEMENTS = {
                'ê°‘': 'ëª©', 'ì„': 'ëª©', 'ë³‘': 'í™”', 'ì •': 'í™”', 'ë¬´': 'í† ',
                'ê¸°': 'í† ', 'ê²½': 'ê¸ˆ', 'ì‹ ': 'ê¸ˆ', 'ì„': 'ìˆ˜', 'ê³„': 'ìˆ˜'
            };
            const element = FIVE_ELEMENTS[dayMaster];
            
            let mainAdvice = '';
            
            if (relation.specialRelation.type === 'ìœ¡í•©') {
                mainAdvice = `ì˜¤ëŠ˜ì€ ìœ¡í•©ì˜ ì¡°í™”ë¡œìš´ ê¸°ìš´ì´ ê°€ë“í•œ ë‚ ì…ë‹ˆë‹¤. ${dayMaster}ì¼ì£¼ì¸ ë‹¹ì‹ ì˜ ì¥ì ì´ ìµœëŒ€í•œ ë°œíœ˜ë  ìˆ˜ ìˆìœ¼ë‹ˆ, í‰ì†Œ ë¯¸ë¤„ì™”ë˜ ì¤‘ìš”í•œ ì¼ì„ ì§„í–‰í•´ë³´ì„¸ìš”.`;
            } else if (relation.specialRelation.type === 'ì¶©') {
                mainAdvice = `ì¶©ì˜ ë³€í™” ì—ë„ˆì§€ê°€ ê°•í•œ ë‚ ì…ë‹ˆë‹¤. ì˜ˆìƒì¹˜ ëª»í•œ ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆì§€ë§Œ, ì´ëŠ” ìƒˆë¡œìš´ ê¸°íšŒê°€ ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.`;
            } else {
                mainAdvice = `${element}ì˜ íŠ¹ì„±ì„ ì‚´ë ¤ ì°¨ë¶„í•˜ê³  ì‹ ì¤‘í•˜ê²Œ í•˜ë£¨ë¥¼ ë³´ë‚´ì„¸ìš”. í° ë³€í™”ë³´ë‹¤ëŠ” ì¼ìƒì˜ ì†Œì¤‘í•¨ì„ ëŠë¼ë©° ë‚´ì  ì„±ì¥ì— ì§‘ì¤‘í•˜ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤.`;
            }
            
            const doList = {
                'ëª©': 'ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ ì‹œì‘',
                'í™”': 'í”„ë ˆì  í…Œì´ì…˜ì´ë‚˜ ë°œí‘œ',
                'í† ': 'ê³„íš ìˆ˜ë¦½ê³¼ ì •ë¦¬',
                'ê¸ˆ': 'ì¤‘ìš”í•œ ê²°ì •',
                'ìˆ˜': 'í•™ìŠµê³¼ ì—°êµ¬'
            };
            
            const dontList = {
                'ëª©': 'ê³ ì§‘ìŠ¤ëŸ¬ìš´ íƒœë„',
                'í™”': 'ê³¼ë„í•œ ì—´ì •',
                'í† ': 'ìš°ìœ ë¶€ë‹¨í•¨',
                'ê¸ˆ': 'ìœµí†µì„± ë¶€ì¡±',
                'ìˆ˜': 'ì±…ì„ íšŒí”¼'
            };
            
            return {
                advice: mainAdvice,
                doAdvice: doList[element],
                dontAdvice: dontList[element]
            };
        }
        
        // ì ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ
        function getScoreColor(score) {
            if (score >= 85) return '#10b981';
            if (score >= 70) return '#3b82f6';
            if (score >= 55) return '#f59e0b';
            return '#ef4444';
        }
        
        // ì¹´ì¹´ì˜¤í†¡ ê³µìœ  ê¸°ëŠ¥ (ìˆ˜ì •ë¨)
        function shareFortune() {
            if (typeof Kakao !== 'undefined' && currentFortuneData) {
                const { userName, saju, fortune, today } = currentFortuneData;
                const dayMaster = saju.dayPillar.stem + saju.dayPillar.branch;
                
                const detailedDescription = `ğŸ”® ${userName}ë‹˜ì˜ ${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼ ìš´ì„¸

ğŸ’« ì´ìš´: ${fortune.overallScore}ì  | â¤ï¸ ì• ì •ìš´: ${fortune.loveScore}ì 
ğŸ’° ê¸ˆì „ìš´: ${fortune.moneyScore}ì  | ğŸƒ ê±´ê°•ìš´: ${fortune.healthScore}ì 

â­ ì‚¬ì£¼: ${dayMaster}ì¼ì£¼
ğŸŒŸ ${fortune.overallFortune}

ğŸ€ í–‰ìš´ ìš”ì†Œ
â° ì‹œê°„: ${fortune.luckyTime}
ğŸ§­ ë°©í–¥: ${fortune.luckyDirection}
ğŸ¨ ìƒ‰ìƒ: ${fortune.luckyColor}
ğŸ”¢ ìˆ«ì: ${fortune.luckyNumber}

ë§Œì„¸ë ¥ ê¸°ë°˜ ì •í™•í•œ ì‚¬ì£¼ ìš´ì„¸ í™•ì¸í•˜ê¸° ğŸ‘‡`;
                
                Kakao.Share.sendDefault({
                    objectType: 'feed',
                    content: {
                        title: `ğŸ”® ${userName}ë‹˜ì˜ ì˜¤ëŠ˜ ìš´ì„¸ - ${dayMaster}ì¼ì£¼`,
                        description: detailedDescription,
                        imageUrl: 'https://doha.kr/images/og-default.png',
                        link: {
                            mobileWebUrl: window.location.href,
                            webUrl: window.location.href,
                        },
                    },
                    buttons: [
                        {
                            title: 'ë‚˜ë„ ìš´ì„¸ ë³´ê¸°',
                            link: {
                                mobileWebUrl: 'https://doha.kr/fortune/daily/',
                                webUrl: 'https://doha.kr/fortune/daily/'
                            }
                        }
                    ]
                });
            } else {
                copyResultLink();
            }
        }
        
        // ë§í¬ ë³µì‚¬
        function copyResultLink() {
            const url = window.location.href;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(() => {
                    alert('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                });
            } else {
                alert('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
    </script>
    
    <!-- AdSense initialization -->
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</body>
</html>