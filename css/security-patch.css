/* Security Patch CSS for doha.kr */
/* Prevents XSS attacks and improves security through CSS */

/* Content Security Policy Enforcement via CSS */
/* Disable inline styles that could be XSS vectors */
* {
    /* Prevent CSS injection attacks */
    -webkit-user-modify: read-only;
    -moz-user-modify: read-only;
    user-modify: read-only;
}

/* Input Security */
input, textarea, select {
    /* Prevent autocomplete where sensitive */
    autocomplete: off;
}

input[type="password"] {
    /* Secure password fields */
    autocomplete: new-password;
    -webkit-text-security: disc;
}

input[type="email"] {
    autocomplete: email;
}

/* Iframe Security */
iframe {
    /* Prevent clickjacking */
    pointer-events: none;
    border: 2px solid #ef4444;
    background: #fef2f2;
}

iframe[src*="youtube.com"],
iframe[src*="vimeo.com"],
iframe[src*="google.com"] {
    /* Allow trusted iframes */
    pointer-events: auto;
    border: none;
    background: transparent;
}

/* Link Security */
a[href^="http"]:not([href*="doha.kr"])::after {
    /* Mark external links */
    content: " ‚Üó";
    color: #f59e0b;
    font-weight: bold;
}

a[target="_blank"] {
    /* Secure external links */
    rel: "noopener noreferrer";
}

/* Form Security Indicators */
form:not([action*="doha.kr"]) {
    /* Warn about external form submissions */
    border: 3px solid #ef4444 !important;
    background: linear-gradient(45deg, #fef2f2 25%, transparent 25%, transparent 75%, #fef2f2 75%),
                linear-gradient(45deg, #fef2f2 25%, transparent 25%, transparent 75%, #fef2f2 75%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
}

form:not([action*="doha.kr"])::before {
    content: "‚ö†Ô∏è External Form - Check URL";
    display: block;
    background: #ef4444;
    color: white;
    padding: 8px;
    text-align: center;
    font-weight: bold;
    margin-bottom: 10px;
}

/* Script Tag Security (for dynamic content) */
script:not([src*="doha.kr"]):not([src*="google"]):not([src*="googlesyndication"]):not([src*="googleapis"]):not([src*="gstatic"]):not([src*="jsdelivr"]):not([src*="cdnjs"]) {
    /* Visual indicator for potentially unsafe scripts */
    display: block !important;
    background: #fef2f2;
    border: 2px solid #ef4444;
    padding: 10px;
    margin: 10px 0;
    color: #dc2626;
    font-family: monospace;
    white-space: pre-wrap;
}

script:not([src*="doha.kr"]):not([src*="google"]):not([src*="googlesyndication"]):not([src*="googleapis"]):not([src*="gstatic"]):not([src*="jsdelivr"]):not([src*="cdnjs"])::before {
    content: "‚ö†Ô∏è EXTERNAL SCRIPT DETECTED: " attr(src);
    display: block;
    font-weight: bold;
    color: #dc2626;
}

/* Image Security */
img[src^="data:"] {
    /* Highlight data URLs which could contain malicious content */
    border: 2px solid #f59e0b;
    background: #fffbeb;
}

img[src^="javascript:"] {
    /* Block javascript: URLs in images */
    display: none !important;
}

/* CSS Injection Prevention */
*[style*="javascript:"],
*[style*="expression("],
*[style*="@import"],
*[style*="behavior:"] {
    /* Block potentially malicious inline styles */
    background: #fef2f2 !important;
    border: 3px solid #ef4444 !important;
    color: #dc2626 !important;
}

*[style*="javascript:"]::before,
*[style*="expression("]::before,
*[style*="@import"]::before,
*[style*="behavior:"]::before {
    content: "üö´ BLOCKED: Malicious style detected";
    display: block;
    background: #ef4444;
    color: white;
    padding: 4px 8px;
    font-weight: bold;
    font-size: 12px;
}

/* Content Validation */
.user-content {
    /* Sanitize user-generated content areas */
    word-wrap: break-word;
    overflow-wrap: break-word;
    max-width: 100%;
}

.user-content script {
    display: none !important;
}

.user-content iframe {
    display: none !important;
}

.user-content object,
.user-content embed,
.user-content applet {
    display: none !important;
}

/* Privacy Protection */
.privacy-sensitive {
    /* Blur sensitive information */
    filter: blur(4px);
    transition: filter 0.3s ease;
}

.privacy-sensitive:hover,
.privacy-sensitive:focus {
    filter: none;
}

/* Analytics Blocking Indicator */
.analytics-blocked {
    background: #f3f4f6;
    border: 1px solid #d1d5db;
    padding: 8px;
    text-align: center;
    font-size: 12px;
    color: #6b7280;
}

.analytics-blocked::before {
    content: "üîí Analytics Blocked by Privacy Settings";
}

/* Development/Debug Indicators */
.debug-info {
    background: #1f2937;
    color: #f9fafb;
    padding: 4px 8px;
    font-family: monospace;
    font-size: 12px;
    border: 1px solid #374151;
}

/* Security Headers Visualization */
.security-header-missing {
    background: linear-gradient(45deg, #fef2f2 25%, transparent 25%);
    border-left: 4px solid #ef4444;
    padding-left: 8px;
}

.security-header-present {
    border-left: 4px solid #10b981;
    padding-left: 8px;
}

/* Cookie Consent Styling */
.cookie-consent {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #1f2937;
    color: white;
    padding: 16px;
    z-index: 9999;
    box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
}

.cookie-consent a {
    color: #60a5fa;
    text-decoration: underline;
}

/* Ad Safety */
.adsbygoogle {
    /* Mark ad containers for transparency */
    position: relative;
}

.adsbygoogle::before {
    content: "Í¥ëÍ≥†";
    position: absolute;
    top: -20px;
    right: 0;
    background: #6b7280;
    color: white;
    padding: 2px 6px;
    font-size: 10px;
    border-radius: 2px;
    z-index: 1;
}

/* Rate Limiting Visual Feedback */
.rate-limited {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    padding: 8px;
    border-radius: 4px;
    color: #92400e;
}

.rate-limited::before {
    content: "‚è≥ Rate Limited - Please Wait";
    font-weight: bold;
}

/* HTTPS Enforcement Indicator */
.insecure-content {
    background: #fef2f2;
    border: 2px solid #ef4444;
    padding: 10px;
    color: #dc2626;
}

.insecure-content::before {
    content: "üîì INSECURE CONTENT DETECTED";
    display: block;
    font-weight: bold;
    margin-bottom: 8px;
}