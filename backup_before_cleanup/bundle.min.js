!function(){"use strict";const t={sanitizeHTML:function(t){if(!t)return"";if("undefined"!=typeof DOMPurify)return DOMPurify.sanitize(t);const e=document.createElement("div");return e.textContent=t,e.innerHTML},sanitizeAttr:function(t){return t?String(t).replace(/['"<>&]/g,function(t){return{'"':"&quot;","'":"&#x27;","<":"&lt;",">":"&gt;","&":"&amp;"}[t]}):""},sanitizeURL:function(t){if(!t)return"";try{const e=new URL(t,window.location.href);return["http:","https:","mailto:"].includes(e.protocol)?e.href:(// console.warn removed("Blocked potentially dangerous URL:",t),"")}catch(e){return // console.error removed("Invalid URL:",t),""}},validateNumber:function(t,e=0,n=1/0){const r=parseFloat(t);return isNaN(r)||!isFinite(r)?e:Math.max(e,Math.min(n,r))},validateEmail:function(t){if(!t)return!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t).toLowerCase())},validatePhone:function(t){if(!t)return!1;const e=t.replace(/\D/g,"");return/^(01[0-9]{8,9}|02[0-9]{7,8}|0[3-9][0-9]{7,8})$/.test(e)},generateCSRFToken:function(){return window.crypto&&window.crypto.getRandomValues?[...crypto.getRandomValues(new Uint8Array(32))].map(t=>t.toString(16).padStart(2,"0")).join(""):Date.now().toString(36)+Math.random().toString(36).substr(2)},validateCSRFToken:function(t,e){return!(!t||!e)&&t===e},escapeRegex:function(t){return t?t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""},containsDangerousContent:function(t){if(!t)return!1;return[/<script[^>]*>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe/gi,/<object/gi,/<embed/gi,/eval\s*\(/gi,/expression\s*\(/gi].some(e=>e.test(t))},safeJSONParse:function(t,e=null){try{return JSON.parse(t)}catch(t){return // console.error removed("JSON parse error:",t),e}},validateAllowedChars:function(t,e=!1){if(!t)return!0;return(e?/^[가-힣a-zA-Z0-9\s\-\_\.\,\!\?\@\#\$\%\&\*\(\)\[\]\{\}]+$/:/^[가-힣a-zA-Z0-9\s\-\_\.\,\!\?]+$/).test(t)},createSafeElement:function(t,e,n={}){const r=document.createElement(t);return e&&(r.textContent=e),Object.keys(n).forEach(t=>{if(t.toLowerCase().startsWith("on"))return void // console.warn removed("Event handler attributes not allowed");const e=this.sanitizeAttr(n[t]);r.setAttribute(t,e)}),r},getCSPNonce:function(){const t=document.querySelector('meta[name="csp-nonce"]');return t?t.content:""},createRateLimiter:function(t,e){const n=[];return function(){const r=Date.now(),o=r-e;for(;n.length>0&&n[0]<o;)n.shift();return n.length>=t?(// console.warn removed("Rate limit exceeded"),!1):(n.push(r),!0)}}};window.Security=t,document.addEventListener("DOMContentLoaded",function(){document.addEventListener("input",function(e){if(e.target.matches('input[type="text"], input[type="email"], textarea')){const n=e.target.maxLength||1e3;e.target.value.length>n&&(e.target.value=e.target.value.substring(0,n))}}),document.addEventListener("submit",function(e){const n=e.target.querySelectorAll("input, textarea, select");for(let r of n)if(t.containsDangerousContent(r.value))return e.preventDefault(),// console.error removed("Form submission blocked: dangerous content detected"),"function"==typeof showNotification?showNotification("입력 내용에 허용되지 않는 문자가 포함되어 있습니다.","error"):alert("입력 내용에 허용되지 않는 문자가 포함되어 있습니다."),!1})}),// console.log removed("Security utilities loaded successfully")}();
!function(){"use strict";const e={config:{enableConsoleLog:!0,enableAnalytics:!0,maxErrorsPerSession:50,retryAttempts:3,retryDelay:1e3},errorCount:0,errorCache:new Set,init:function(){this.setupGlobalErrorHandlers(),this.setupPromiseRejectionHandler(),this.setupResourceErrorHandlers(),// console.log removed("Error handling system initialized")},setupGlobalErrorHandlers:function(){const e=this;window.addEventListener("error",function(r){e.handleError({type:"javascript",message:r.message,filename:r.filename,lineno:r.lineno,colno:r.colno,error:r.error,stack:r.error?r.error.stack:null})})},setupPromiseRejectionHandler:function(){const e=this;window.addEventListener("unhandledrejection",function(r){e.handleError({type:"promise",message:"Unhandled Promise Rejection",reason:r.reason,promise:r.promise,stack:r.reason&&r.reason.stack?r.reason.stack:null}),r.preventDefault()})},setupResourceErrorHandlers:function(){const e=this;document.addEventListener("error",function(r){"IMG"===r.target.tagName&&(e.handleResourceError("image",r.target.src),e.handleImageError(r.target))},!0),document.addEventListener("error",function(r){"SCRIPT"===r.target.tagName&&e.handleResourceError("script",r.target.src)},!0),document.addEventListener("error",function(r){"LINK"===r.target.tagName&&"stylesheet"===r.target.rel&&e.handleResourceError("stylesheet",r.target.href)},!0)},handleError:function(e){if(this.errorCount>=this.config.maxErrorsPerSession)return;const r=this.createErrorSignature(e);this.errorCache.has(r)||(this.errorCount++,this.errorCache.add(r),this.config.enableConsoleLog&&// console.error removed("🚨 Error caught by global handler:",e),this.config.enableAnalytics&&this.sendToAnalytics(e),this.isCriticalError(e)&&this.showUserErrorMessage(e),this.attemptRecovery(e))},handleResourceError:function(e,r){const n={type:"resource",resourceType:e,src:r,message:`Failed to load ${e}: ${r}`};this.handleError(n)},handleImageError:function(e){e.dataset.errorHandled||(e.dataset.errorHandled="true",e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIE5vdCBGb3VuZDwvdGV4dD48L3N2Zz4=",e.alt="Image not found")},createErrorSignature:function(e){return`${e.type}_${e.message}_${e.filename||""}_${e.lineno||""}`},isCriticalError:function(e){const r=(e.message||"").toLowerCase();return["network","fetch","api","security","permission","quota"].some(e=>r.includes(e))},showUserErrorMessage:function(e){const r={network:"네트워크 연결을 확인해 주세요.",fetch:"데이터를 불러오는 중 문제가 발생했습니다. 잠시 후 다시 시도해 주세요.",api:"서비스에 일시적인 문제가 발생했습니다. 잠시 후 다시 시도해 주세요.",security:"보안 오류가 발생했습니다. 페이지를 새로고침해 주세요.",permission:"권한 오류가 발생했습니다.",quota:"저장 공간이 부족합니다. 브라우저 캐시를 정리해 주세요."},n=(e.message||"").toLowerCase();let t="일시적인 오류가 발생했습니다. 페이지를 새로고침해 주세요.";for(const[e,o]of Object.entries(r))if(n.includes(e)){t=o;break}this.showNotification(t,"error")},showNotification:function(e,r="info"){if("function"==typeof showNotification)return void showNotification(e,r);const n=document.createElement("div");n.className=`error-notification ${r}`,n.innerHTML=`<div class="notification-content"><span class="notification-icon">${"error"===r?"⚠️":"ℹ️"}</span><span class="notification-message">${this.escapeHtml(e)}</span><button class="notification-close" onclick="this.parentElement.parentElement.remove()">×</button></div>`,n.style.cssText=`position: fixed;top: 20px;right: 20px;z-index: 10000;background: ${"error"===r?"#ff4444":"#4CAF50"};color: white;padding: 15px;border-radius: 5px;box-shadow: 0 2px 10px rgba(0,0,0,0.3);max-width: 400px;animation: slideIn 0.3s ease-out;`,document.body.appendChild(n),setTimeout(()=>{n.parentElement&&n.remove()},5e3)},escapeHtml:function(e){const r=document.createElement("div");return r.textContent=e,r.innerHTML},sendToAnalytics:function(e){try{"undefined"!=typeof gtag&&gtag("event","exception",{description:e.message,fatal:this.isCriticalError(e),error_type:e.type,file:e.filename||"unknown",line:e.lineno||0}),"undefined"!=typeof Analytics&&Analytics.trackError&&Analytics.trackError(e)}catch(e){// console.warn removed("Failed to send error to analytics:",e)}},attemptRecovery:function(e){"promise"===e.type&&e.message.includes("fetch")&&this.retryFailedRequest(e),"resource"===e.type&&this.retryResourceLoad(e)},retryFailedRequest:function(e){e.retryCount>=this.config.retryAttempts||(e.retryCount=(e.retryCount||0)+1,setTimeout(()=>{// console.log removed(`Retrying failed request (attempt ${e.retryCount})`)},this.config.retryDelay*e.retryCount))},retryResourceLoad:function(e){"script"===e.resourceType&&e.src.includes("main")&&setTimeout(()=>{const r=document.createElement("script");r.src=e.src,document.head.appendChild(r)},2e3)},safeExecute:function(e,r=null,n=[]){try{return e.apply(r,n)}catch(r){return this.handleError({type:"wrapped_function",message:r.message,stack:r.stack,functionName:e.name||"anonymous"}),null}},safeExecuteAsync:async function(e,r=null,n=[]){try{return await e.apply(r,n)}catch(r){return this.handleError({type:"wrapped_async_function",message:r.message,stack:r.stack,functionName:e.name||"anonymous"}),null}},reportError:function(e,r={}){this.handleError({type:"manual",message:e,details:r,stack:(new Error).stack})},clearErrorCache:function(){this.errorCache.clear(),this.errorCount=0},getErrorStats:function(){return{totalErrors:this.errorCount,cachedErrors:this.errorCache.size,maxErrors:this.config.maxErrorsPerSession}}};window.ErrorHandler=e,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e.init()}):e.init(),// console.log removed("Global error handler loaded successfully")}();