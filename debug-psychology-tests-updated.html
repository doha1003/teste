<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychology Tests Debug - Updated</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
        .warning { color: orange; }
        button { padding: 10px 20px; margin: 5px; }
        iframe { width: 100%; height: 600px; border: 1px solid #ddd; margin: 10px 0; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ì‹¬ë¦¬í…ŒìŠ¤íŠ¸ ë””ë²„ê¹… ë„êµ¬</h1>
    
    <div class="test-section">
        <h2>1. íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸</h2>
        <div id="file-check-results"></div>
        <button onclick="checkFiles()">íŒŒì¼ ì²´í¬</button>
    </div>

    <div class="test-section">
        <h2>2. JavaScript ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸</h2>
        <div id="module-load-results"></div>
        <button onclick="testModuleLoading()">ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸</button>
    </div>

    <div class="test-section">
        <h2>3. MBTI í…ŒìŠ¤íŠ¸ ì‹¤í–‰</h2>
        <div id="mbti-test-results"></div>
        <button onclick="testMBTI()">MBTI í…ŒìŠ¤íŠ¸</button>
        <iframe id="mbti-frame" src="/tests/mbti/test.html" style="display:none;"></iframe>
    </div>

    <div class="test-section">
        <h2>4. Love DNA í…ŒìŠ¤íŠ¸ ì‹¤í–‰</h2>
        <div id="love-dna-test-results"></div>
        <button onclick="testLoveDNA()">Love DNA í…ŒìŠ¤íŠ¸</button>
        <iframe id="love-dna-frame" src="/tests/love-dna/test.html" style="display:none;"></iframe>
    </div>

    <div class="test-section">
        <h2>5. Teto-Egen í…ŒìŠ¤íŠ¸ ì‹¤í–‰</h2>
        <div id="teto-egen-test-results"></div>
        <button onclick="testTetoEgen()">Teto-Egen í…ŒìŠ¤íŠ¸</button>
        <iframe id="teto-egen-frame" src="/tests/teto-egen/test.html" style="display:none;"></iframe>
    </div>

    <script>
        async function checkFiles() {
            const results = document.getElementById('file-check-results');
            results.innerHTML = '<div class="info">íŒŒì¼ ì²´í¬ ì¤‘...</div>';
            
            const filesToCheck = [
                '/dist/styles.min.css',
                '/js/app.js',
                '/js/mbti-questions.js',
                '/js/features/tests/mbti-test.js',
                '/js/features/tests/love-dna-test.js',
                '/js/features/tests/teto-egen-test.js',
                '/js/features/tests/test-service.js',
                '/js/api-config.js',
                '/js/core/service-base.js'
            ];
            
            let html = '';
            for (const file of filesToCheck) {
                try {
                    const response = await fetch(file);
                    if (response.ok) {
                        html += `<div class="success">âœ… ${file} - ë¡œë“œ ì„±ê³µ</div>`;
                    } else {
                        html += `<div class="error">âŒ ${file} - HTTP ${response.status}</div>`;
                    }
                } catch (error) {
                    html += `<div class="error">âŒ ${file} - ì˜¤ë¥˜: ${error.message}</div>`;
                }
            }
            results.innerHTML = html;
        }

        async function testModuleLoading() {
            const results = document.getElementById('module-load-results');
            results.innerHTML = '<div class="info">ëª¨ë“ˆ ë¡œë”© í…ŒìŠ¤íŠ¸ ì¤‘...</div>';
            
            let html = '';
            
            try {
                // API Config ë¡œë“œ
                await import('/js/api-config.js');
                html += '<div class="success">âœ… API Config ë¡œë“œ ì„±ê³µ</div>';
            } catch (error) {
                html += `<div class="error">âŒ API Config ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
            
            try {
                // Service Base ë¡œë“œ
                await import('/js/core/service-base.js');
                html += '<div class="success">âœ… Service Base ë¡œë“œ ì„±ê³µ</div>';
            } catch (error) {
                html += `<div class="error">âŒ Service Base ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
            
            try {
                // MBTI Questions ë¡œë“œ
                const mbtiModule = await import('/js/mbti-questions.js');
                html += `<div class="success">âœ… MBTI Questions ë¡œë“œ ì„±ê³µ (${mbtiModule.mbtiQuestions?.length || 0}ë¬¸í•­)</div>`;
            } catch (error) {
                html += `<div class="error">âŒ MBTI Questions ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
            
            try {
                // Test Service ë¡œë“œ
                await import('/js/features/tests/test-service.js');
                html += '<div class="success">âœ… Test Service ë¡œë“œ ì„±ê³µ</div>';
            } catch (error) {
                html += `<div class="error">âŒ Test Service ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
            
            try {
                // MBTI Test ë¡œë“œ
                const mbtiTestModule = await import('/js/features/tests/mbti-test.js');
                html += `<div class="success">âœ… MBTI Test Service ë¡œë“œ ì„±ê³µ</div>`;
                
                if (mbtiTestModule.mbtiTest) {
                    html += '<div class="info">ğŸ” MBTI Test Service ì¸ìŠ¤í„´ìŠ¤ í™•ì¸ë¨</div>';
                } else {
                    html += '<div class="warning">âš ï¸ MBTI Test Service ì¸ìŠ¤í„´ìŠ¤ê°€ ì—†ìŒ</div>';
                }
            } catch (error) {
                html += `<div class="error">âŒ MBTI Test Service ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
            
            results.innerHTML = html;
        }

        function testMBTI() {
            const results = document.getElementById('mbti-test-results');
            const frame = document.getElementById('mbti-frame');
            
            results.innerHTML = '<div class="info">MBTI í…ŒìŠ¤íŠ¸ ë¡œë”© ì¤‘...</div>';
            frame.style.display = 'block';
            
            frame.onload = function() {
                try {
                    const frameDoc = frame.contentDocument || frame.contentWindow.document;
                    const startButton = frameDoc.querySelector('.test-start-button');
                    
                    let html = '';
                    if (startButton) {
                        html += '<div class="success">âœ… ì‹œì‘ ë²„íŠ¼ ë°œê²¬</div>';
                        
                        // ì½˜ì†” ë¡œê·¸ ìº¡ì²˜ë¥¼ ìœ„í•œ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                        const originalLog = frameDoc.defaultView.console.log;
                        let consoleLogs = [];
                        frameDoc.defaultView.console.log = function(...args) {
                            consoleLogs.push(args.join(' '));
                            originalLog.apply(console, args);
                        };
                        
                        // ë²„íŠ¼ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜
                        setTimeout(() => {
                            startButton.click();
                            
                            setTimeout(() => {
                                // ì½˜ì†” ë¡œê·¸ í‘œì‹œ
                                html += '<div class="info">ğŸ“ ì½˜ì†” ë¡œê·¸:</div>';
                                consoleLogs.forEach(log => {
                                    html += `<div class="info" style="font-size: 12px; margin-left: 20px;">${log}</div>`;
                                });
                                
                                const testScreen = frameDoc.querySelector('#test-screen');
                                const questionElement = frameDoc.querySelector('#question');
                                const introScreen = frameDoc.querySelector('#intro-screen');
                                
                                html += '<div class="info">ğŸ” DOM ìƒíƒœ:</div>';
                                html += `<div class="info">â€¢ intro-screen display: ${introScreen ? frameDoc.defaultView.getComputedStyle(introScreen).display : 'not found'}</div>`;
                                html += `<div class="info">â€¢ test-screen display: ${testScreen ? frameDoc.defaultView.getComputedStyle(testScreen).display : 'not found'}</div>`;
                                html += `<div class="info">â€¢ question element exists: ${questionElement ? 'yes' : 'no'}</div>`;
                                
                                if (testScreen && !testScreen.classList.contains('hidden')) {
                                    html += '<div class="success">âœ… í…ŒìŠ¤íŠ¸ í™”ë©´ í‘œì‹œë¨</div>';
                                    if (questionElement) {
                                        if (questionElement.textContent && questionElement.textContent.trim()) {
                                            html += `<div class="success">âœ… ì²« ë²ˆì§¸ ì§ˆë¬¸ ë¡œë“œë¨: "${questionElement.textContent.substring(0, 50)}..."</div>`;
                                        } else {
                                            html += '<div class="error">âŒ ì§ˆë¬¸ ìš”ì†ŒëŠ” ìˆì§€ë§Œ ë‚´ìš©ì´ ë¹„ì–´ìˆìŒ</div>';
                                        }
                                    } else {
                                        html += '<div class="error">âŒ ì§ˆë¬¸ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ</div>';
                                    }
                                } else {
                                    html += '<div class="error">âŒ í…ŒìŠ¤íŠ¸ í™”ë©´ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ</div>';
                                    html += `<div class="error">â€¢ í…ŒìŠ¤íŠ¸ í™”ë©´ í´ë˜ìŠ¤: ${testScreen ? testScreen.className : 'element not found'}</div>`;
                                }
                                
                                // window ê°ì²´ í™•ì¸
                                html += '<div class="info">ğŸ” Window ê°ì²´:</div>';
                                html += `<div class="info">â€¢ window.mbtiQuestions: ${frameDoc.defaultView.window.mbtiQuestions ? frameDoc.defaultView.window.mbtiQuestions.length + ' ë¬¸í•­' : 'not found'}</div>`;
                                html += `<div class="info">â€¢ window.mbtiTest: ${frameDoc.defaultView.window.mbtiTest ? 'exists' : 'not found'}</div>`;
                                
                                results.innerHTML = html;
                            }, 3000); // ë” ê¸´ ëŒ€ê¸° ì‹œê°„
                        }, 1000);
                    } else {
                        html += '<div class="error">âŒ ì‹œì‘ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ</div>';
                        results.innerHTML = html;
                    }
                } catch (error) {
                    results.innerHTML = `<div class="error">âŒ MBTI í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}</div>`;
                }
            };
            
            frame.onerror = function() {
                results.innerHTML = '<div class="error">âŒ MBTI í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì‹¤íŒ¨</div>';
            };
        }

        function testLoveDNA() {
            const results = document.getElementById('love-dna-test-results');
            const frame = document.getElementById('love-dna-frame');
            
            results.innerHTML = '<div class="info">Love DNA í…ŒìŠ¤íŠ¸ ë¡œë”© ì¤‘...</div>';
            frame.style.display = 'block';
            
            frame.onload = function() {
                try {
                    const frameDoc = frame.contentDocument || frame.contentWindow.document;
                    const startButton = frameDoc.querySelector('.test-start-button');
                    
                    let html = '';
                    if (startButton) {
                        html += '<div class="success">âœ… ì‹œì‘ ë²„íŠ¼ ë°œê²¬</div>';
                        
                        setTimeout(() => {
                            startButton.click();
                            setTimeout(() => {
                                const testScreen = frameDoc.querySelector('#test-screen');
                                const questionElement = frameDoc.querySelector('#question');
                                
                                if (testScreen && !testScreen.classList.contains('hidden')) {
                                    html += '<div class="success">âœ… í…ŒìŠ¤íŠ¸ í™”ë©´ í‘œì‹œë¨</div>';
                                    if (questionElement && questionElement.textContent) {
                                        html += `<div class="success">âœ… ì²« ë²ˆì§¸ ì§ˆë¬¸ ë¡œë“œë¨: "${questionElement.textContent.substring(0, 50)}..."</div>`;
                                    } else {
                                        html += '<div class="error">âŒ ì§ˆë¬¸ì´ ë¡œë“œë˜ì§€ ì•ŠìŒ</div>';
                                    }
                                } else {
                                    html += '<div class="error">âŒ í…ŒìŠ¤íŠ¸ í™”ë©´ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ</div>';
                                }
                                results.innerHTML = html;
                            }, 2000);
                        }, 1000);
                    } else {
                        html += '<div class="error">âŒ ì‹œì‘ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ</div>';
                        results.innerHTML = html;
                    }
                } catch (error) {
                    results.innerHTML = `<div class="error">âŒ Love DNA í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}</div>`;
                }
            };
        }

        function testTetoEgen() {
            const results = document.getElementById('teto-egen-test-results');
            const frame = document.getElementById('teto-egen-frame');
            
            results.innerHTML = '<div class="info">Teto-Egen í…ŒìŠ¤íŠ¸ ë¡œë”© ì¤‘...</div>';
            frame.style.display = 'block';
            
            frame.onload = function() {
                try {
                    const frameDoc = frame.contentDocument || frame.contentWindow.document;
                    const startButton = frameDoc.querySelector('.test-start-button');
                    
                    let html = '';
                    if (startButton) {
                        html += '<div class="success">âœ… ì‹œì‘ ë²„íŠ¼ ë°œê²¬</div>';
                        
                        setTimeout(() => {
                            startButton.click();
                            setTimeout(() => {
                                const genderScreen = frameDoc.querySelector('#gender-selection-screen');
                                const testScreen = frameDoc.querySelector('#test-screen');
                                
                                if (genderScreen && !genderScreen.classList.contains('hidden')) {
                                    html += '<div class="success">âœ… ì„±ë³„ ì„ íƒ í™”ë©´ í‘œì‹œë¨</div>';
                                } else if (testScreen && !testScreen.classList.contains('hidden')) {
                                    html += '<div class="success">âœ… í…ŒìŠ¤íŠ¸ í™”ë©´ í‘œì‹œë¨</div>';
                                } else {
                                    html += '<div class="error">âŒ ë‹¤ìŒ í™”ë©´ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ</div>';
                                }
                                results.innerHTML = html;
                            }, 2000);
                        }, 1000);
                    } else {
                        html += '<div class="error">âŒ ì‹œì‘ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ</div>';
                        results.innerHTML = html;
                    }
                } catch (error) {
                    results.innerHTML = `<div class="error">âŒ Teto-Egen í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}</div>`;
                }
            };
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ íŒŒì¼ ì²´í¬ ì‹¤í–‰
        window.addEventListener('load', () => {
            checkFiles();
        });
    </script>
</body>
</html>