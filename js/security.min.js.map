{"version":3,"names":["Security","sanitizeHTML","str","DOMPurify","sanitize","div","document","createElement","textContent","innerHTML","sanitizeAttr","String","replace","match","sanitizeURL","url","parsed","URL","window","location","href","includes","protocol","console","warn","e","error","validateNumber","input","min","max","Infinity","num","parseFloat","isNaN","isFinite","Math","validateEmail","email","test","toLowerCase","validatePhone","phone","cleaned","generateCSRFToken","crypto","getRandomValues","Uint8Array","map","b","toString","padStart","join","Date","now","random","substr","validateCSRFToken","token","storedToken","escapeRegex","containsDangerousContent","some","pattern","safeJSONParse","defaultValue","JSON","parse","validateAllowedChars","allowSpecial","createSafeElement","tagName","attributes","element","Object","keys","forEach","key","startsWith","value","this","setAttribute","getCSPNonce","meta","querySelector","content","createRateLimiter","maxCalls","timeWindow","calls","cutoff","length","shift","push","addEventListener","target","matches","maxLength","substring","inputs","querySelectorAll","preventDefault","showNotification","alert","log"],"sources":["js/security.js"],"mappings":"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","ignoreList":[]}