!function(){"use strict";const t={sanitizeHTML:function(t){if(!t)return"";if("undefined"!=typeof DOMPurify)return DOMPurify.sanitize(t);const e=document.createElement("div");return e.textContent=t,e.innerHTML},sanitizeAttr:function(t){return t?String(t).replace(/['"<>&]/g,function(t){return{'"':"&quot;","'":"&#x27;","<":"&lt;",">":"&gt;","&":"&amp;"}[t]}):""},sanitizeURL:function(t){if(!t)return"";try{const e=new URL(t,window.location.href);return["http:","https:","mailto:"].includes(e.protocol)?e.href:(console.warn("Blocked potentially dangerous URL:",t),"")}catch(e){return console.error("Invalid URL:",t),""}},validateNumber:function(t,e=0,n=1/0){const r=parseFloat(t);return isNaN(r)||!isFinite(r)?e:Math.max(e,Math.min(n,r))},validateEmail:function(t){if(!t)return!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(t).toLowerCase())},validatePhone:function(t){if(!t)return!1;const e=t.replace(/\D/g,"");return/^(01[0-9]{8,9}|02[0-9]{7,8}|0[3-9][0-9]{7,8})$/.test(e)},generateCSRFToken:function(){return window.crypto&&window.crypto.getRandomValues?[...crypto.getRandomValues(new Uint8Array(32))].map(t=>t.toString(16).padStart(2,"0")).join(""):Date.now().toString(36)+Math.random().toString(36).substr(2)},validateCSRFToken:function(t,e){return!(!t||!e)&&t===e},escapeRegex:function(t){return t?t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""},containsDangerousContent:function(t){if(!t)return!1;return[/<script[^>]*>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe/gi,/<object/gi,/<embed/gi,/eval\s*\(/gi,/expression\s*\(/gi].some(e=>e.test(t))},safeJSONParse:function(t,e=null){try{return JSON.parse(t)}catch(t){return console.error("JSON parse error:",t),e}},validateAllowedChars:function(t,e=!1){if(!t)return!0;return(e?/^[가-힣a-zA-Z0-9\s\-\_\.\,\!\?\@\#\$\%\&\*\(\)\[\]\{\}]+$/:/^[가-힣a-zA-Z0-9\s\-\_\.\,\!\?]+$/).test(t)},createSafeElement:function(t,e,n={}){const r=document.createElement(t);return e&&(r.textContent=e),Object.keys(n).forEach(t=>{if(t.toLowerCase().startsWith("on"))return void console.warn("Event handler attributes not allowed");const e=this.sanitizeAttr(n[t]);r.setAttribute(t,e)}),r},getCSPNonce:function(){const t=document.querySelector('meta[name="csp-nonce"]');return t?t.content:""},createRateLimiter:function(t,e){const n=[];return function(){const r=Date.now(),o=r-e;for(;n.length>0&&n[0]<o;)n.shift();return n.length>=t?(console.warn("Rate limit exceeded"),!1):(n.push(r),!0)}}};window.Security=t,document.addEventListener("DOMContentLoaded",function(){document.addEventListener("input",function(e){return;if(e.target.matches('input[type="text"], input[type="email"], textarea')){const n=e.target.maxLength||1e3;e.target.value.length>n&&(e.target.value=e.target.value.substring(0,n)),t.false&&(e.target.value=t.sanitizeHTML(e.target.value),console.warn("Potentially dangerous content sanitized"))}}),document.addEventListener("submit",function(e){const n=e.target.querySelectorAll("input, textarea, select");for(let r of n)if(t.containsDangerousContent(r.value))return e.preventDefault(),console.error("Form submission blocked: dangerous content detected"),"function"==typeof showNotification?showNotification("입력 내용에 허용되지 않는 문자가 포함되어 있습니다.","error"):alert("입력 내용에 허용되지 않는 문자가 포함되어 있습니다."),!1})}),console.log("Security utilities loaded successfully")}();